"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}require(["./requirejs.config"],function(){require(["jquery","footer","cartheader","cookie"],function(){var t=JSON.parse($.cookie("cart"));console.log(_typeof($.cookie("cart")));var e=$("#product-out"),a=$("#product"),c="",n=!0,o=!1,r=void 0;try{for(var s,i=t[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var l=s.value;c+='\n            <div class="middle" id="'.concat(l.id,'">\n                <span><a href="javascript:;" class="check" data-check="1"></a></span>\n                <a href="./detail.html"><img src="').concat(l.img,'"></a>\n                <p>\n                    <span>').concat(l.title,"</span>\n                    <span>").concat(l.ml,'</span>\n                    <a href="javascript:;" class="deleteBtn">删除</a>\n                </p>\n                <span class="price">').concat(l.price,'</span>\n                <p>\n                    <span class="redBtn">-</span>\n                    <span class="num">').concat(l.pnum,'</span>\n                    <span class="addBtn">+</span>\n                </p>\n                <span class="sum"></span>\n            </div>')}}catch(t){o=!0,r=t}finally{try{n||null==i.return||i.return()}finally{if(o)throw r}}e.html(c),e.on("click",".addBtn",function(){var t=$(this).prev(".num").text(),e=$(this).parent("p").prev(".price").text().slice(1);$(this).prev(".num").text(++t),$(this).parent("p").next(".sum").text("￥"+t*e);var a=JSON.parse($.cookie("cart"));$(".num").each(function(t,e){a[t].pnum=$(e).text()}),$.cookie("cart",JSON.stringify(a),{path:"/",expires:3}),h()}),e.on("click",".redBtn",function(){var t=$(this).next(".num").text(),e=$(this).parent("p").prev(".price").text().slice(1);1<t--&&($(this).next(".num").text(t),$(this).parent("p").next(".sum").text("￥"+t*e));var a=JSON.parse($.cookie("cart"));$(".num").each(function(t,e){a[t].pnum=$(e).text()}),$.cookie("cart",JSON.stringify(a),{path:"/",expires:3}),console.log($.cookie("cart")),h()}),console.log($(".check")),a.on("click",".deleteBtn",function(){if(confirm("确定删除此商品吗？")){var t=$(this).parent("p").parent(".middle").attr("id");console.log(t);for(var e=JSON.parse($.cookie("cart")),a=0;a<e.length;a++)if(e[a].id===t){e.splice(a,1);break}$(this).parent("p").parent(".middle").remove(),$.cookie("cart",JSON.stringify(e),{path:"/",expires:3}),h()}console.log($(".check").length),0===$(".check").length&&($(".cart").css({display:"none"}),$(".emptycart").css({display:"block"}))});var p=$(".check").length;function h(){var o=0,r=0;$(".middle").each(function(t,e){for(var a=$(e).attr("id"),c=JSON.parse($.cookie("cart")),n=0;n<c.length;n++)c[n].id===a&&parseInt($(".check").eq(n).attr("data-check"))&&($(".sum").eq(n).text("￥"+c[n].price.slice(1)*c[n].pnum),r+=parseInt(c[n].pnum),o+=parseInt(c[n].price.slice(1)*c[n].pnum))}),$(".cartNum").text(r),$(".money").text("￥"+o)}function d(){for(var t=JSON.parse($.cookie("cart")),e=0;e<$(".check").length;e++)parseInt($(".check").eq(e).attr("data-check"))||(t.splice(e,1),console.log(t));$.cookie("order",JSON.stringify(t),{path:"/",expires:3})}$("#allCheck").on("click",function(){var t=$(this).attr("data-allCheck"),e=$(".check");parseInt(t)?($(this).addClass("al"),e.addClass("ac"),$(this).attr("data-allCheck",0),e.attr("data-check",0),$(".money").text("￥0")):($(this).removeClass("al"),e.removeClass("ac"),$(this).attr("data-allCheck",1),e.attr("data-check",1),h(),d())}),$(".check").on("click",function(){var t=$(this).attr("data-check");parseInt(t)?($(this).addClass("ac"),$("#allCheck").addClass("al"),$(this).attr("data-check",0),p--):($(this).removeClass("ac"),$("#allCheck").removeClass("al"),$(this).attr("data-check",1),p++),h(),d(),p!==$(".check").length&&($("#allCheck").attr("data-check",0),$("#allCheck").addClass("al")),console.log(p)}),console.log(parseInt($(".check").attr("data-check"))),h(),$("#immediate-settlement,#online-consultation").hover(function(){$(this).css({background:"#fff",color:"#000"})},function(){$(this).css({background:"#000",color:"#fff"})}),$("#immediate-settlement").on("click",function(){$.cookie("user")?confirm("确定下单吗？")&&(d(),setTimeout(function(){window.location.href="/html/order.html"},1e3)):(alert("请到登录页面登录"),window.location.href="./login.html")})})});